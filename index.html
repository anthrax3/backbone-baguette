<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=640" />

    <link rel="stylesheet" href="stylesheets/core.css" media="screen"/>
    <link rel="stylesheet" href="stylesheets/mobile.css" media="handheld, only screen and (max-device-width:640px)"/>
    <link rel="stylesheet" href="stylesheets/pygment_trac.css"/>

    <script type="text/javascript" src="javascripts/modernizr.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="javascripts/headsmart.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function () {
        $('#main_content').headsmart()
      })
    </script>
    <title>Backbone-baguette by spacenick</title>
  </head>

  <body>
    <a id="forkme_banner" href="https://github.com/spacenick/backbone-baguette">View on GitHub</a>
    <div class="shell">

      <header>
        <span class="ribbon-outer">
          <span class="ribbon-inner">
            <h1>Backbone-baguette</h1>
            <h2>Freshly toasted backbone library. Provides tools and helpers for a super quick backbone development in smalls to mediums applications.</h2>
          </span>
          <span class="left-tail"></span>
          <span class="right-tail"></span>
        </span>
      </header>

      <section id="downloads">
        <span class="inner">
          <a href="https://github.com/spacenick/backbone-baguette/zipball/master" class="zip"><em>download</em> .ZIP</a><a href="https://github.com/spacenick/backbone-baguette/tarball/master" class="tgz"><em>download</em> .TGZ</a>
        </span>
      </section>


      <span class="banner-fix"></span>


      <section id="main_content">
        <h1>Backbone Baguette</h1>

<p>Nothing better than concrete examples to understand how you can baguettize your Backbone development.</p>

<h6>Examples data</h6>

<p>All the following examples will use the following models and collection : </p>

<div class="highlight"><pre>
<span class="c1">// Basic models and collection</span>
<span class="kd">var</span> <span class="nx">Car</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">extend</span><span class="p">({});</span>
<span class="kd">var</span> <span class="nx">toyota</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Car</span><span class="p">({</span><span class="nx">brand</span><span class="o">:</span><span class="s2">"Toyota"</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s2">"Yaris"</span><span class="p">});</span>
<span class="kd">var</span> <span class="nx">bmw</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Car</span><span class="p">({</span><span class="nx">brand</span><span class="o">:</span><span class="s2">"BMW"</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s2">"M3"</span><span class="p">});</span>

<span class="kd">var</span> <span class="nx">Garage</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Collection</span><span class="p">.</span><span class="nx">extend</span><span class="p">({});</span>
<span class="kd">var</span> <span class="nx">myGarage</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Garage</span><span class="p">([</span><span class="nx">toyota</span><span class="p">,</span><span class="nx">bmw</span><span class="p">]);</span>

<span class="c1">// And a more complex Model</span>
<span class="kd">var</span> <span class="nx">garageLocation</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Model</span><span class="p">({</span><span class="nx">city</span><span class="o">:</span><span class="s2">"Paris"</span><span class="p">,</span><span class="nx">gps</span><span class="o">:</span><span class="s2">"0.55 0.12"</span><span class="p">});</span>
<span class="kd">var</span> <span class="nx">garageModel</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Model</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span><span class="s2">"Peugeot"</span><span class="p">,</span><span class="nx">location</span><span class="o">:</span><span class="nx">garageLocation</span><span class="p">,</span><span class="nx">cars</span><span class="o">:</span><span class="nx">myGarage</span><span class="p">});</span>

</pre></div>

<h6>Render a Model View</h6>

<p>When we're writing in Backbone, we quickly notice that we're writing a lot of similar views which are actually just using a template engine (such as Mustache or Handlebars) to render a JSON converted model. Instead of re-writing all the time the <em>template(this.model.toJSON())..</em> code you can baguettize it to achieve this, by using the <strong>Backbone.Baguette.ModelView</strong> component.</p>

<p><strong>With Backbone Baguette</strong></p>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">ModelView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Baguette</span><span class="p">.</span><span class="nx">ModelView</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="nx">tpl</span><span class="o">:</span><span class="s2">"My car is a {{brand}} {{name}}"</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">myView</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ModelView</span><span class="p">({</span><span class="nx">model</span><span class="o">:</span><span class="nx">toyota</span><span class="p">});</span>

<span class="nx">myView</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">$el</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="s1">'body'</span><span class="p">);</span> <span class="c1">// Appends to the body "My car is a Toyota Yaris"</span>
</pre></div>

<p>Here we are using a "classic" Mustache-style template; but the default template engine used in Baguette is Handlebars. </p>

<p>If you wish to change this, you have to edit the global configuration of Baguette and change the templating function, which takes a string template and a JSON object and return the templated string. </p>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">TemplatingFunction</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">tpl</span><span class="p">,</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">compile</span><span class="p">(</span><span class="nx">tpl</span><span class="p">)(</span><span class="nx">data</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">Backbone</span><span class="p">.</span><span class="nx">Baguette</span><span class="p">.</span><span class="nx">templating</span> <span class="o">=</span> <span class="nx">TemplatingFunction</span><span class="p">;</span>
</pre></div>

<p>You can also specify individually the templating property on each CompositeView, if you want to only edit some views and not the global Baguette templating function.</p>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">ModelView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Baguette</span><span class="p">.</span><span class="nx">ModelView</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="nx">tpl</span><span class="o">:</span><span class="s2">"My car is a {{brand}} {{name}}"</span><span class="p">,</span>
  <span class="nx">templating</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">tpl</span><span class="p">,</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
     <span class="k">return</span> <span class="nx">MyCustomTemplateEngine</span><span class="p">(</span><span class="nx">tpl</span><span class="p">).</span><span class="nx">CustomRenderMethod</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>

<p>Since I am a fanatic of <a href="http://requirejs.org/">RequireJS</a>, tpl attribute is for now only supporting a raw string because I'm using the awesome <a href="https://github.com/requirejs/text">text plugin</a> to load asynchronosouly my .tpl files. Support for a jQuery selector to fetch a script text/template will be added soon!</p>

<p><strong>Without Backbone Baguette</strong></p>

<p>Basically we are rewriting all the time the good old render method which pretty much looks always the same...</p>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">ModelView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

    <span class="nx">render</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">templated</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">compile</span><span class="p">(</span><span class="nx">tpl</span><span class="p">)(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">());</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">templated</span><span class="p">);</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>         
    <span class="p">}</span>  
<span class="p">});</span>
</pre></div>

<h6>Rendering a collection</h6>

<p>You can use the <strong>Backbone.Baguette.CollectionView</strong> to avoid writing the redundant <em>this.collection.each(....)</em> code.</p>

<p>To achieve this you can define the <strong>modelView</strong> parameter which is either a Backbone.View (or a Baguette CompositeView obviously) definition (not an instance!) or either a parameter object which can contain the traditional Backbone Views parameters to create an el, such as <strong>tagName</strong>, <strong>className</strong>, etc...</p>

<p><strong>Creating a Collection View using a View definition</strong></p>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">CarView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Baguette</span><span class="p">.</span><span class="nx">ModelView</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
   <span class="nx">tpl</span><span class="o">:</span><span class="s2">"I have a {{brand}} {{name}} in my garage"</span><span class="p">,</span> 
   <span class="nx">tagName</span><span class="o">:</span><span class="s2">"li"</span><span class="p">,</span>
   <span class="nx">events</span><span class="o">:</span><span class="p">{</span>
     <span class="s2">"click"</span><span class="o">:</span><span class="s2">"onClick"</span>
   <span class="p">},</span>
   <span class="nx">onClick</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">());</span>
   <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">GarageView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Baguette</span><span class="p">.</span><span class="nx">CollectionView</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="nx">tagName</span><span class="o">:</span><span class="s2">"ul"</span><span class="p">,</span>
  <span class="nx">modelView</span><span class="o">:</span><span class="nx">CarView</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">myGarageView</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GarageView</span><span class="p">({</span><span class="nx">collection</span><span class="o">:</span><span class="nx">myGarage</span><span class="p">});</span>
<span class="c1">// Render the view =&gt; all the subsequent model views are created!</span>
<span class="nx">myGarageView</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
</pre></div>

<p><em>Your CarViews are passed all the options you gave to your GarageView instance; except obviously the options related to the DOM such as tagName, className, etc...</em></p>

<p><strong>Creating a Collection View using a parameter object</strong></p>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">GarageView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Baguette</span><span class="p">.</span><span class="nx">CollectionView</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="nx">tagName</span><span class="o">:</span><span class="s2">"ul"</span><span class="p">,</span>
  <span class="nx">modelView</span><span class="o">:</span><span class="p">{</span>
   <span class="nx">tagName</span><span class="o">:</span><span class="s2">"li"</span><span class="p">,</span>
   <span class="nx">tpl</span><span class="o">:</span><span class="s2">"I have a {{brand}} {{name}} in my garage"</span>
  <span class="p">}</span>  
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">myGarageView</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GarageView</span><span class="p">({</span><span class="nx">collection</span><span class="o">:</span><span class="nx">myGarage</span><span class="p">});</span>
<span class="c1">// Render the view =&gt; all the subsequent model views are created!</span>
<span class="nx">myGarageView</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">$el</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="s1">'body'</span><span class="p">);</span> <span class="c1">// Our list is appended to the DOM</span>
</pre></div>

<p><em>If you use a parameter object, Baguette will create "anonymous" views inside the render function for you. Therefore you won't be able to define custom attributes -like events or so- on these views, are they will be originals Baguette ModelView objects.</em></p>

<p><strong>Without Backbone Baguette</strong></p>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">GarageView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

    <span class="nx">render</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">empty</span><span class="p">();</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
         <span class="kd">var</span> <span class="nx">newView</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CarView</span><span class="p">({</span><span class="nx">model</span><span class="o">:</span><span class="nx">model</span><span class="p">});</span>
         <span class="nx">that</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">newView</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">$el</span><span class="p">);</span>
      <span class="p">})</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">})</span>
</pre></div>

<h6>Auto bind your view</h6>

<p>Baguette automatically binds your View to the given model (or the given collection). That is, you don't need to rewrite the this.model.on(...) redundant code. We will here reuse the previous CarView.</p>

<p><strong>With Backbone Baguette</strong></p>

<div class="highlight"><pre>
<span class="kd">var</span> <span class="nx">myView</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CarView</span><span class="p">({</span><span class="nx">model</span><span class="o">:</span><span class="nx">toyota</span><span class="p">});</span>
<span class="nx">myView</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">$el</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="s1">'body'</span><span class="p">);</span> <span class="c1">// &lt;div&gt;My car is a Toyota Yaris&lt;/div&gt;</span>

<span class="nx">toyota</span><span class="p">.</span><span class="nx">set</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span><span class="s2">"Yaris 2012"</span><span class="p">});</span>
<span class="c1">// View is automatically refreshed and is set to &lt;div&gt;My car is a Toyota Yaris 2012&lt;/div&gt;</span>
</pre></div>

<p><strong>Without Backbone Baguette</strong></p>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">CarView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

   <span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'change'</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">,</span><span class="k">this</span><span class="p">);</span>
   <span class="p">},</span>
   <span class="nx">render</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">templated</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">compile</span><span class="p">(</span><span class="nx">tpl</span><span class="p">)(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">());</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">templated</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
   <span class="p">}</span>

<span class="p">});</span>
</pre></div>

<p>Collections are also auto binded on the add, reset &amp; remove events, and are calling the render method to repaint the collection view when these events occur.</p>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">myGarageView</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GarageView</span><span class="p">({</span><span class="nx">collection</span><span class="o">:</span><span class="nx">myGarage</span><span class="p">});</span>
<span class="nx">myGarageView</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">$el</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="s1">'body'</span><span class="p">);</span>

<span class="nx">myGarage</span><span class="p">.</span><span class="nx">fetch</span><span class="p">();</span> <span class="c1">// Will auto-render the view if new models are fetched</span>
<span class="nx">myGarage</span><span class="p">.</span><span class="nx">add</span><span class="p">({</span><span class="nx">brand</span><span class="o">:</span><span class="s2">"Peugeot"</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s2">"306"</span><span class="p">});</span> <span class="c1">// View is refreshed with new model</span>
<span class="nx">myGarage</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">toyota</span><span class="p">);</span> <span class="c1">// View is refreshed without the toyota model</span>
</pre></div>

<p><strong>Without Backbone Baguette</strong></p>

<div class="highlight"><pre>
<span class="kd">var</span> <span class="nx">GarageView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

    <span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'add reset remove'</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">,</span><span class="k">this</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="nx">render</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">empty</span><span class="p">();</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
         <span class="kd">var</span> <span class="nx">newView</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CarView</span><span class="p">({</span><span class="nx">model</span><span class="o">:</span><span class="nx">model</span><span class="p">});</span>
         <span class="nx">that</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">newView</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">$el</span><span class="p">);</span>
      <span class="p">})</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">})</span>
</pre></div>

<p><strong>I don't want my Composite Views to auto-bind themselves!</strong></p>

<p>Well then you can right now exit this page. But seriously, you can just add the <strong>noBind</strong> attribute to a ModelView and a CollectionView and set it to <strong>true</strong>; either by defining it in your Class definition, either by passing it as an option when you instantiate your CompositeView.</p>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">NoBindView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Baguette</span><span class="p">.</span><span class="nx">ModelView</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
   <span class="nx">noBind</span><span class="o">:</span><span class="kc">true</span>
<span class="p">});</span>

<span class="c1">// Or you can just do</span>
<span class="k">new</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Baguette</span><span class="p">.</span><span class="nx">CollectionView</span><span class="p">({</span><span class="nx">noBind</span><span class="o">:</span><span class="kc">true</span><span class="p">})</span>
</pre></div>

<h6>Create generic loaders for all your models/collections</h6>

<p>This is not really a Baguette component, but actually Baguette in its source code is patching the <strong>Backbone.sync</strong> method to add a custom "syncing" event when an AJAX call is made. So, for instance, each time you want to fetch a model or a collection, the concerned object will emit the "syncing" event that you will be able to observe, just like the sync/change/reset events. You can then make a generic loader that will work everywhere on any model in your application :</p>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">Loader</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="nx">tagName</span><span class="o">:</span><span class="s1">'img'</span><span class="p">,</span>
  <span class="nx">className</span><span class="o">:</span><span class="s1">'hidden'</span><span class="p">,</span>
  <span class="nx">attributes</span><span class="o">:</span><span class="p">{</span>
   <span class="s1">'src'</span><span class="o">:</span><span class="s1">'loader.gif'</span>
  <span class="p">},</span>
  <span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
   <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'syncing'</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">show</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">);</span>
   <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'change'</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">hide</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">customLoader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Loader</span><span class="p">({</span><span class="nx">model</span><span class="o">:</span><span class="nx">toyota</span><span class="p">});</span>
<span class="nx">customLoader</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">$el</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="s1">'body'</span><span class="p">);</span>
<span class="nx">toyota</span><span class="p">.</span><span class="nx">fetch</span><span class="p">();</span> <span class="c1">// Loader is displayed, and will hide when call is over.</span>
</pre></div>

<p>If you are <strong>already overriding</strong> Backbone.sync you can style call the custom Baguette implementation by using the Backbone.Baguette.sync reference</p>

<div class="highlight"><pre><span class="nx">Backbone</span><span class="p">.</span><span class="nx">sync</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span><span class="nx">model</span><span class="p">,</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>

  <span class="c1">// Doing my custom stuff here </span>

  <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Baguette</span><span class="p">.</span><span class="nx">sync</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span><span class="nx">model</span><span class="p">,</span><span class="nx">options</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<h6>Avoid memory leaks and ghosts views</h6>

<p><a href="http://addyosmani.github.com/backbone-fundamentals/#whats-the-best-way-to-combine-or-append-views-to-each-other">Courtesy of Addy Osmani</a></p>

<p>Basically, when you remove a view from the DOM (using the .remove() native Backbone method), the jQuery events are removed by jQuery itself. But, if you binded your views to a model or a collection, these bindings still exist, and thus, the View cannot be garbage collected as it still have "connection" with other objects.</p>

<p>To avoid this, all the Baguette components are extending from a base component : <strong>Backbone.Baguette.BaseView</strong></p>

<p>BaseView provides the <strong>bindTo</strong> and <strong>destroy</strong> methods which are used to cache our bindings (to remove them later) and properly destroy the view. So if you don't want to use some "high-level" baguette components such as CollectionView or so, you can extend from BaseView instead of extending from Backbone.View. The only thing is that you have to remember is <strong>to use this.bindTo instead of this.model.on(..)</strong></p>

<div class="highlight"><pre>
<span class="kd">var</span> <span class="nx">BasicView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Baguette</span><span class="p">.</span><span class="nx">BaseView</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

   <span class="nx">initialize</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">bindTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">,</span><span class="s2">"event_name"</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">callback</span><span class="p">,</span><span class="k">this</span><span class="p">);</span>
      <span class="c1">// Edited addy's function to add context</span>
   <span class="p">}</span>

<span class="p">});</span>
<span class="kd">var</span> <span class="nx">basicView</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BasicView</span><span class="p">({</span><span class="nx">model</span><span class="o">:</span><span class="nx">toyota</span><span class="p">})</span>
<span class="nx">basicView</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span> <span class="c1">// All the assigned events are properly cleaned + view is removed from the DOM</span>

</pre></div>

<p>Please note that the <strong>CollectionView</strong> and the <strong>CompositeModelView</strong> are automatically calling <strong>destroy</strong> on their child views, to guarantee that every inner views is properly cleaned.</p>

<h6>Rendering Nested Views</h6>

<p>Baguette offers you the ability to manage your nested views in an elegant and simple way. We often need to embed views in a view in order to separate tasks, or for other many reasons. Let's say we want to build a view for a Car and insert to this view a Button that will react to a click. We don't want to bind the click event on the Car view since we can imagine the button View can be reused elsewhre on the application. </p>

<p>You can Baguettize it this way :</p>

<div class="highlight"><pre>
<span class="kd">var</span> <span class="nx">SelectButton</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Baguette</span><span class="p">.</span><span class="nx">BaseView</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="nx">tpl</span><span class="o">:</span><span class="s1">'Info'</span><span class="p">,</span>
  <span class="nx">className</span><span class="o">:</span><span class="s1">'btn btn-primary'</span><span class="p">,</span> <span class="c1">// twitter bootstrap styling</span>
  <span class="nx">events</span><span class="o">:</span><span class="p">{</span>
    <span class="s1">'click'</span><span class="o">:</span><span class="s1">'onClick'</span>
  <span class="p">},</span>
  <span class="nx">onClick</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">());</span>
    <span class="c1">// Print informations or do stuff on Click.</span>
  <span class="p">}</span> 

<span class="p">});</span>

<span class="kd">var</span> <span class="nx">CarView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Baguette</span><span class="p">.</span><span class="nx">CompositeModelView</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="nx">tpl</span><span class="o">:</span><span class="s1">'&lt;p&gt;{{brand}} - {{name}}&lt;/p&gt;&lt;button class="info"&gt;&lt;/button&gt;'</span><span class="p">,</span>
  <span class="nx">nestedViews</span><span class="o">:</span><span class="p">{</span>
    <span class="s2">".info"</span><span class="o">:</span><span class="nx">SelectButton</span>
  <span class="p">}</span>

<span class="p">});</span>

<span class="kd">var</span> <span class="nx">myCarView</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CarView</span><span class="p">({</span><span class="nx">model</span><span class="o">:</span><span class="nx">toyota</span><span class="p">});</span>
<span class="nx">myCarView</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">$el</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="s1">'body'</span><span class="p">);</span>
<span class="c1">// The inner button is rendered and ready to handle the click!</span>
<span class="c1">// Our Car View is also filled with the good *brand* and *name* values</span>

</pre></div>

<p>In the above example, our SelectButton class is instantiated within the CarView render method. Note that <em>all the options -except DOM options-</em> we passed to the CarView when we instantiated it (so here it is {model:toyota}) are given to the nested views.</p>

<p>By default Baguette is using the selector as the <strong>el</strong> for our nested View. But you can also still auto-create the <strong>el</strong> for your nestedView, and add several others options by passing a parameter object which follows this syntax :</p>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">CarView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Baguette</span><span class="p">.</span><span class="nx">CompositeModelView</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

  <span class="nx">tpl</span><span class="o">:</span><span class="s1">'&lt;p&gt;{{brand}} - {{name}}&lt;/p&gt;&lt;button class="info"&gt;&lt;/button&gt;'</span><span class="p">,</span>
  <span class="nx">nestedViews</span><span class="o">:</span><span class="p">{</span>
    <span class="s2">".info"</span><span class="o">:</span><span class="p">{</span>
        <span class="kr">class</span><span class="o">:</span><span class="nx">SelectButton</span><span class="p">,</span>
        <span class="nx">setElement</span><span class="o">:</span><span class="kc">false</span> <span class="c1">// Will append the View INSIDE the selector instead of "replacing" it</span>
     <span class="p">}</span>
  <span class="p">}</span>

<span class="p">});</span>

<span class="kd">var</span> <span class="nx">myCarView</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CarView</span><span class="p">({</span><span class="nx">model</span><span class="o">:</span><span class="nx">toyota</span><span class="p">});</span>
<span class="nx">myCarView</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">$el</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="s1">'body'</span><span class="p">);</span>
<span class="c1">// Now we have the following DOM elements on our body :</span>
<span class="c1">// &lt;div&gt;&lt;p&gt;Toyota - Yaris&lt;/p&gt;&lt;button class="info"&gt;&lt;div&gt;Info&lt;/div&gt;&lt;/button&gt;&lt;/div&gt;</span>
<span class="c1">// As we set setElement to false our NestedView is auto-creating its $el which is appended</span>
<span class="c1">// to our .info container. (tagName is "div" by default in backbone)</span>

</pre></div>

<h6>Deeper dive in Nested Views : mixing it up</h6>

<p>We saw how to use CompositeModelView to manage our nested views. It happens that sometimes, our models are a little bit more complex than plain raw JSON object (like our <strong>garageModel</strong> we defined in the examples). Well, CompositeModelView can handle that pretty well as you can see :</p>

<div class="highlight"><pre>    <span class="c1">// locationView which will be nested. Simple model view</span>
    <span class="kd">var</span> <span class="nx">locationView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Baguette</span><span class="p">.</span><span class="nx">ModelView</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">tpl</span><span class="o">:</span><span class="s2">"In {{city}} at gps coord {{gps}}"</span>
    <span class="p">})</span>
    <span class="c1">// Our more complex layout for a garage complex object</span>
    <span class="kd">var</span> <span class="nx">compositeView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Baguette</span><span class="p">.</span><span class="nx">CompositeModelView</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>

       <span class="nx">tpl</span><span class="o">:</span><span class="s2">"&lt;p&gt;{{name}}&lt;/p&gt;&lt;p class='location'&gt;&lt;/p&gt;&lt;p class='cars'&gt;&lt;/p&gt;"</span><span class="p">,</span>
        <span class="nx">nestedViews</span><span class="o">:</span><span class="p">{</span>
            <span class="s1">'.cars'</span><span class="o">:</span><span class="p">{</span>
                <span class="kr">class</span><span class="o">:</span><span class="nx">GarageView</span><span class="p">,</span> <span class="c1">// reusing our CollectionView we defined before</span>
                <span class="nx">setElement</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span> <span class="c1">// will append INSIDE the container</span>
                <span class="nx">collectionAttribute</span><span class="o">:</span><span class="s1">'cars'</span>
            <span class="p">},</span>
            <span class="s1">'.location'</span><span class="o">:</span><span class="p">{</span>
                <span class="kr">class</span><span class="o">:</span><span class="nx">locationView</span><span class="p">,</span>
                <span class="nx">modelAttribute</span><span class="o">:</span><span class="s1">'location'</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="kd">var</span> <span class="nx">myCompositeView</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">compositeView</span><span class="p">({</span><span class="nx">model</span><span class="o">:</span><span class="nx">garageModel</span><span class="p">});</span>
    <span class="nx">myCompositeView</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">$el</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="s1">'body'</span><span class="p">);</span>
<span class="cm">/* RESULT :</span>
<span class="cm">&lt;div&gt;</span>
<span class="cm"> &lt;p&gt;Peugeot&lt;/p&gt;</span>
<span class="cm">  &lt;p class="location"&gt;In Paris at gps coord 0.001&lt;/p&gt;</span>
<span class="cm">  &lt;p class="cars"&gt;</span>
<span class="cm">    &lt;ul&gt;</span>
<span class="cm">     &lt;li&gt;My car is a Toyota Yaris&lt;/li&gt;</span>
<span class="cm">     &lt;li&gt;My car is a BMW M3&lt;/li&gt;</span>
<span class="cm">    &lt;/ul&gt;</span>
<span class="cm">   &lt;/p&gt;</span>
<span class="cm">&lt;/div&gt;</span>
<span class="cm">*/</span>
</pre></div>

<p>You can specify that a nested view is deeply linked to one of our sub-models or sub-collections. You just have to define the collectionAttribute or the modelAttribute and assign it to the string value of the concerned model field. Magic!</p>

<h1>Baguette Components</h1>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">MyViewClass</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Baguette</span><span class="p">.</span><span class="nx">CompositeView</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
   <span class="c1">// properties goes here</span>
<span class="p">});</span>

<span class="c1">// Classic instantiation of the view</span>
<span class="kd">var</span> <span class="nx">myView</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyViewClass</span><span class="p">();</span>

</pre></div>

<h1>Global Configuration</h1>
      </section>

      <footer>
        <span class="ribbon-outer">
          <span class="ribbon-inner">
            <p>this project by <a href="https://github.com/spacenick">spacenick</a> can be found on <a href="https://github.com/spacenick/backbone-baguette">GitHub</a></p>
          </span>
          <span class="left-tail"></span>
          <span class="right-tail"></span>
        </span>
        <p>Generated with <a href="http://pages.github.com">GitHub Pages</a> using Merlot</p>
        <span class="octocat"></span>
      </footer>

    </div>

    
  </body>
</html>
